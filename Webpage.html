<!DOCTYPE html>
<html lang="en" class="dark"> <!-- 預設為深色模式 -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ITBM-EMI - Executive Course Hub</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        bcg: {
                            green: '#177a46',
                            dark: '#1e1e1e',
                            light: '#f3f4f6',
                            textDark: '#e5e7eb',
                            textLight: '#111827'
                        }
                    },
                    fontFamily: {
                        sans: ['Roboto', 'Noto Sans TC', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace']
                    }
                }
            }
        }
    </script>
    
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        body, header, footer, div, span, p, h1, h2, h3, button, nav, a, li, ul, label, section, main {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        #sidebar { transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        
        .playing-indicator span {
            display: inline-block; width: 3px; height: 10px; background-color: currentColor; margin: 0 1px; animation: wave 1s infinite ease-in-out;
        }
        .playing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .playing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes wave { 0%, 100% { height: 10px; } 50% { height: 16px; } }

        .tbd-card {
            background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(100,100,100,0.05) 10px, rgba(100,100,100,0.05) 20px);
        }
        .dark .tbd-card {
            background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.03) 10px, rgba(255,255,255,0.03) 20px);
        }

        /* 科技感複選框樣式 */
        .tech-check:checked + div {
            border-color: #177a46;
            background-color: rgba(23, 122, 70, 0.05);
        }
        /* 當任務完成時顯示刪除線與透明度 */
        .tech-check:checked + div .task-title {
            text-decoration: line-through;
            opacity: 0.5;
        }

        @keyframes blob {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }
        .animate-blob { animation: blob 7s infinite; }
        .animation-delay-2000 { animation-delay: 2s; }

        /* 關鍵字 Tooltip 樣式 */
        .keyword {
            border-bottom: 1.5px dotted #177a46;
            cursor: help;
            position: relative;
            display: inline;
            -webkit-user-select: none;
            user-select: none;
        }
        .dark .keyword {
            border-bottom-color: #4ade80;
        }
        
        .keyword::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 125%;
            left: var(--tip-left, 50%);
            transform: var(--tip-transform, translateX(-50%)) translateY(10px);
            background: #1f2937;
            color: #fff;
            padding: 10px 14px;
            border-radius: 8px;
            font-size: 11px;
            width: max-content;
            max-width: 260px;
            white-space: normal;
            box-shadow: 0 10px 25px -5px rgba(0,0,0,0.4);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, transform 0.2s ease;
            z-index: 100;
            pointer-events: none;
            line-height: 1.5;
            font-weight: normal;
            text-align: left;
        }

        @media (max-width: 640px) {
            .keyword::after {
                max-width: 92vw;
                font-size: 10.5px;
            }
        }

        .keyword:hover::after, .keyword.show-tip::after {
            opacity: 1;
            visibility: visible;
            transform: var(--tip-transform, translateX(-50%)) translateY(0);
        }

        /* 自定義動畫：導航箭頭 */
        @keyframes bounce-x {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(5px); }
        }
        .animate-bounce-x {
            animation: bounce-x 1s infinite;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen bg-white dark:bg-bcg-dark text-gray-900 dark:text-bcg-textDark font-sans transition-colors duration-300 overflow-x-hidden">

    <!-- 任務完成彈窗 -->
    <div id="complete-modal" class="fixed inset-0 z-[100] flex items-center justify-center hidden px-4">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-md"></div>
        <div class="relative bg-white dark:bg-bcg-dark border border-bcg-green/30 rounded-2xl p-8 max-w-md w-full shadow-[0_0_50px_rgba(23,122,70,0.3)] overflow-hidden animate-in fade-in zoom-in duration-300">
            <div class="absolute -top-24 -left-24 w-48 h-48 bg-bcg-green/20 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"></div>
            <div class="absolute -bottom-24 -right-24 w-48 h-48 bg-blue-500/20 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"></div>
            
            <div class="relative z-10 text-center">
                <div class="w-20 h-20 bg-bcg-green rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg shadow-bcg-green/40 relative">
                    <i class="fas fa-trophy text-white text-3xl"></i>
                </div>
                
                <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-8 uppercase tracking-tight">
                    <span class="lang-en">Mission Accomplished!</span>
                    <span class="lang-zh hidden">任務順利達成！</span>
                </h3>
                
                <div class="flex flex-col space-y-3">
                    <a href="https://lolopodcast.github.io/1142-ITBM-EMI/" target="_blank" class="w-full py-3 bg-bcg-green text-white rounded-xl font-bold hover:bg-green-700 transition shadow-lg shadow-bcg-green/20 text-center flex items-center justify-center space-x-2">
                        <span class="lang-en">Mysterious Hall of Knowledge (Not a Scam) <i class="fas fa-external-link-alt ml-1 text-xs"></i></span>
                        <span class="lang-zh hidden">前往神秘知識殿堂(非詐騙) <i class="fas fa-external-link-alt ml-1 text-xs"></i></span>
                    </a>
                    <button onclick="closeModal()" class="w-full py-3 border border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 rounded-xl font-medium hover:bg-gray-50 dark:hover:bg-white/5 transition">
                        <span class="lang-en">Reluctantly give up(stay here)</span>
                        <span class="lang-zh hidden">忍痛放棄，留在原頁</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 頁首導航 -->
    <header class="fixed w-full top-0 z-50 h-14 flex items-center justify-between px-2 sm:px-3 md:px-6 bg-white dark:bg-black/95 shadow-md border-b border-gray-200 dark:border-gray-800 transition-all duration-300">
        <div class="flex items-center h-full">
            <button id="menu-btn" class="text-gray-700 dark:text-gray-300 hover:text-bcg-green focus:outline-none transition p-2 mr-1 sm:mr-2">
                <i class="fas fa-bars text-lg"></i>
            </button>
            <!-- LOGO: 跳回首頁頁首 -->
            <div onclick="switchSection(event, 'overview')" class="cursor-pointer mr-2 sm:mr-4 border-r border-gray-300 dark:border-gray-700 pr-2 sm:pr-4 h-8 flex items-center group">
                <span class="font-bold text-lg sm:text-xl tracking-wider text-bcg-green leading-none uppercase group-hover:opacity-80 transition-opacity">ITBM</span>
            </div>
            <div class="hidden lg:flex flex-col justify-center h-full py-1">
                <div class="text-[10px] text-gray-600 dark:text-gray-400 font-medium leading-none mb-0.5 uppercase tracking-tighter">
                    <span class="lang-en">Industry Trends and Business Models</span>
                    <span class="lang-zh hidden">新興產業趨勢與商業模式-全英授課</span>
                </div>
                <div class="text-[9px] text-gray-500 dark:text-gray-500 leading-tight uppercase">
                    <span class="lang-en">Executive Course Hub (EMI)</span>
                    <span class="lang-zh hidden">課程資訊中心 (EMI)</span>
                </div>
            </div>
        </div>

        <h1 class="absolute left-1/2 transform -translate-x-1/2 text-[12px] sm:text-lg md:text-xl font-bold text-gray-900 dark:text-gray-100 tracking-tighter sm:tracking-wide text-center uppercase whitespace-nowrap">
            <span class="lang-en">NOTIFICATION</span>
            <span class="lang-zh hidden">課程通知</span>
        </h1>

        <div class="flex items-center space-x-1 sm:space-x-2">
             <button id="audio-btn" class="w-7 h-7 rounded-full flex items-center justify-center text-gray-600 dark:text-gray-400 hover:text-bcg-green hover:bg-gray-100 dark:hover:bg-white/10 transition" title="Audio Guide">
                <i class="fas fa-headphones text-sm"></i>
            </button>
            <button id="theme-toggle" class="w-7 h-7 rounded-full flex items-center justify-center text-gray-600 dark:text-gray-400 hover:text-yellow-500 hover:bg-gray-100 dark:hover:bg-white/10 transition">
                <i class="fas fa-sun text-sm"></i>
            </button>
            <button id="lang-toggle" class="text-[9px] sm:text-[10px] font-bold border border-gray-400 dark:border-gray-600 text-gray-800 dark:text-gray-300 rounded px-1 sm:px-1.5 py-0.5 hover:border-bcg-green hover:text-bcg-green transition whitespace-nowrap bg-transparent uppercase">
                ENG / 繁中
            </button>
        </div>
    </header>

    <!-- 側邊欄導航 -->
    <div id="overlay" class="fixed inset-0 bg-black/50 z-40 hidden backdrop-blur-sm transition-opacity"></div>
    <div id="sidebar" class="fixed top-0 left-0 w-fit min-w-[200px] max-w-[85vw] h-full bg-white dark:bg-bcg-dark border-r border-gray-200 dark:border-gray-700 z-50 transform -translate-x-full shadow-2xl flex flex-col">
        <div onclick="toggleSidebar()" class="h-14 flex items-center justify-between px-6 border-b border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-black/20 cursor-pointer hover:bg-gray-100 dark:hover:bg-white/5 transition group">
            <span class="font-bold text-lg text-gray-800 dark:text-white tracking-widest group-hover:text-bcg-green transition">NAVIGATOR</span>
            <i class="fas fa-chevron-left text-gray-400 group-hover:text-bcg-green transition text-sm"></i>
        </div>

        <nav class="flex-1 overflow-y-auto no-scrollbar py-4 space-y-1">
            <a href="#" onclick="switchSection(event, 'overview')" id="nav-overview" class="block px-6 py-4 border-l-4 border-bcg-green bg-gray-100 dark:bg-white/5 text-bcg-green dark:text-white whitespace-nowrap">
                <div class="flex items-center">
                    <span class="w-6 text-center mr-3"><i class="fas fa-book-open"></i></span>
                    <span class="lang-en">Course Brief</span><span class="lang-zh hidden">課程簡介</span>
                </div>
            </a>
            <a href="#" onclick="switchSection(event, 'w1-orientation')" id="nav-w1-orientation" class="block px-6 py-4 border-l-4 border-transparent text-gray-700 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-white/5 transition whitespace-nowrap">
                <div class="flex items-center">
                    <span class="w-6 text-center mr-3"><i class="fas fa-compass"></i></span>
                    <span class="lang-en">W1 Orientation</span><span class="lang-zh hidden">第一週 課程定位</span>
                </div>
            </a>
            <a href="#" onclick="switchSection(event, 'w2-onboarding')" id="nav-w2-onboarding" class="block px-6 py-4 border-l-4 border-transparent text-gray-700 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-white/5 transition whitespace-nowrap">
                <div class="flex items-center">
                    <span class="w-6 text-center mr-3"><i class="fas fa-rocket"></i></span>
                    <span class="lang-en">W2 Onboarding</span><span class="lang-zh hidden">第二週 課程啟航</span>
                </div>
            </a>
        </nav>
    </div>

    <!-- 主要內容區 -->
    <main class="flex-1 pt-20 pb-20 px-4 max-w-6xl mx-auto w-full">
        
        <!-- 區塊：課程簡介 (Overview) -->
        <div id="section-overview" class="animate-fade-in relative">
            
            <div class="fixed right-6 top-1/2 -translate-y-1/2 z-40 flex items-center">
                <button onclick="switchSection(event, 'w2-onboarding')" class="w-14 h-14 rounded-full bg-bcg-green text-white flex items-center justify-center transition-all duration-300 shadow-[0_0_30px_rgba(23,122,70,0.6)] hover:scale-110 active:scale-95 group animate-pulse" title="Next: W2 Onboarding">
                    <i class="fas fa-arrow-right text-xl animate-bounce-x"></i>
                    <span class="absolute right-20 bg-bcg-dark text-white text-[11px] font-bold px-3 py-1.5 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap border border-gray-700 pointer-events-none shadow-xl">
                        <span class="lang-en">W2 Onboarding <i class="fas fa-angle-double-right ml-1"></i></span>
                        <span class="lang-zh hidden">前往第二週課程啟航 <i class="fas fa-angle-double-right ml-1"></i></span>
                    </span>
                </button>
            </div>

            <div id="hero-banner" class="bg-bcg-green text-white p-8 rounded-lg mb-8 shadow-xl">
                <div class="flex justify-between items-start mb-4">
                    <span class="text-xs font-bold uppercase tracking-widest opacity-80">Spring 2026 | ITBM-EMI</span>
                </div>
                <h2 class="text-3xl font-bold mb-2 audio-target">
                    <span class="lang-en">Industry Trends and Business Models</span>
                    <span class="lang-zh hidden">新興產業趨勢與商業模式</span>
                </h2>
                <p class="text-lg opacity-90 italic audio-target">
                    <span class="lang-en">"Become a competent Product Manager in MNCs"</span>
                    <span class="lang-zh hidden">「成為頂尖跨國企業產品經理」</span>
                </p>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-8 pt-8 border-t border-white/20 text-sm">
                    <div class="audio-target">
                        <p class="opacity-70 text-[10px] uppercase font-bold"><span class="lang-en">Class Time</span><span class="lang-zh hidden">上課時間</span></p>
                        <p class="font-medium"><span class="lang-en">Wed 3bcd (9:10~12:00)</span><span class="lang-zh hidden">每星期三(9:10~12:00)</span></p>
                    </div>
                    <div class="audio-target">
                        <p class="opacity-70 text-[10px] uppercase font-bold"><span class="lang-en">Location</span><span class="lang-zh hidden">教室</span></p>
                        <p class="font-medium"><span class="lang-en">MGMT B15</span><span class="lang-zh hidden">管理學院B15</span></p>
                    </div>
                    <div class="audio-target">
                        <p class="opacity-70 text-[10px] uppercase font-bold"><span class="lang-en">Instructor</span><span class="lang-zh hidden">授課教授</span></p>
                        <p class="font-medium"><span class="lang-en">Prof. Shihmin Lo</span><span class="lang-zh hidden">駱世民教授</span></p>
                    </div>
                    <div class="audio-target">
                        <p class="opacity-70 text-[10px] uppercase font-bold"><span class="lang-en">Credits</span><span class="lang-zh hidden">學分數</span></p>
                        <p class="font-medium"><span class="lang-en">3 Units</span><span class="lang-zh hidden">三學分</span></p>
                    </div>
                </div>
            </div>

            <div class="space-y-8">
                <div class="border-l-4 border-bcg-green pl-6">
                    <h3 class="text-xl font-bold mb-4 uppercase tracking-wider text-bcg-green audio-target">
                        <span class="lang-en">Course Brief</span><span class="lang-zh hidden">課程簡介</span>
                    </h3>
                    <div class="text-sm text-gray-700 dark:text-gray-300 leading-relaxed mb-4 space-y-4 audio-target">
                        <p class="lang-en">
                            The goal of this course is to empower students to analyze any new industry with confidence—executing professional communication in English, leveraging AI effectively, and applying structured thinking. 
                            This course adopts a <span class="keyword" data-tip="A teaching model where students study topics at home and practice applying knowledge in class.">Flipped Classroom</span> model, emphasizing the appropriate use of <span class="keyword" data-tip="AI that can create new content, like text, images, or code.">Generative AI</span> tools (e.g., ChatGPT, NotebookLM) to support learning while avoiding over-reliance. The instructional design is centered on <span class="keyword" data-tip="Problem-Based Learning: Students learn about a subject through the experience of solving an open-ended problem.">Problem-Based Learning (PBL)</span>, <span class="keyword" data-tip="Self-Directed Learning: The process in which individuals take initiative in their own learning.">Self-Directed Learning (SDL)</span>, and team-based collaborative learning.
                        </p>
                        <p class="lang-en">
                            To effectively formulate and execute industrial policy, corporate strategy, and <span class="keyword" data-tip="The act of cooperation between competing companies.">co-opetition</span>, it is essential to develop a profound understanding of <span class="keyword" data-tip="Stages an industry passes through from inception to decline.">Industry Life Cycles</span>, Innovative Business Models, and Co-opetitive Dynamics. We view industry as a collective of both established firms and startups, analyzing upward, horizontal, and downward trends through the temporal dimensions of points, lines, and planes. Through the analysis of emerging technologies and practical industry cases, students will learn how leading firms build strategic positions, cultivate the competencies required of a <span class="keyword" data-tip="Product Manager: Responsible for the strategy, roadmap, and feature definition for that product.">Product Manager (PM)</span>.
                        </p>

                        <!-- 中文內容 -->
                        <p class="lang-zh hidden">
                            本課程的目標是賦予學生自信地分析任何新興產業的能力——包括執行專業英語溝通、有效利用 AI，並應用結構化思維。
                            課程採用<span class="keyword" data-tip="學生課前預習教材，課堂時間用於實務練習與深入討論。">「翻轉課堂」</span>模式，強調正確使用<span class="keyword" data-tip="能生成文字、圖像或代碼的新興人工智慧技術。">生成式 AI</span> 工具（如 ChatGPT、NotebookLM）輔助學習，同時避免過度依賴。教學設計核心為<span class="keyword" data-tip="問題導向學習：透過解決現實世界問題來獲獲取知識。">「問題導向學習 (PBL)」</span>、<span class="keyword" data-tip="自主學習：學習者主動採取行動並引導學習。">「自主學習 (SDL)」</span>與團隊協作學習。
                        </p>
                        <p class="lang-zh hidden">
                            為了有效制定與執行產業政策、企業策略與競合關係，必須深入理解<span class="keyword" data-tip="產業從出現、成長、成熟到衰退的演進過程。">產業生命週期</span>、創新商業模式與<span class="keyword" data-tip="競爭與合作並存的動態關係。">競合動態</span>。我們將產業視為成熟企業與新創公司的集合體，透過點、線、面的時間維度分析向上、水平與向下的趨勢。透過新興技術分析與產業實務案例，學生將學習領先企業如何建立策略定位，培養<span class="keyword" data-tip="產品經理：負責產品策略、藍圖與功能定義。">產品經理 (PM)</span> 必備職能。
                        </p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 p-6 rounded-lg">
                        <h4 class="font-bold mb-3 flex items-center text-bcg-green audio-target"><i class="fas fa-book mr-2"></i> <span class="lang-en">Materials</span><span class="lang-zh hidden">課程教材</span></h4>
                        <ul class="text-xs space-y-3 text-gray-600 dark:text-gray-400">
                            <li class="flex items-start group audio-target">
                                <span class="mr-2">•</span>
                                <a href="https://www.youtube.com/@shihminlo6097/playlists" target="_blank" class="text-red-600 dark:text-red-400 hover:underline flex items-center">
                                    <strong>YouTube:</strong> Prof. Lo's ITBM Playlist <i class="fas fa-external-link-alt ml-1.5 text-[8px]"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 p-6 rounded-lg">
                        <h4 class="font-bold mb-3 flex items-center text-bcg-green audio-target"><i class="fas fa-tools mr-2"></i> <span class="lang-en">AI Toolkit</span><span class="lang-zh hidden">AI 工具箱</span></h4>
                        <div class="flex flex-wrap gap-2">
                            <a href="https://chat.openai.com" target="_blank" class="audio-target px-2 py-1 bg-gray-100 dark:bg-white/10 rounded text-[10px] hover:bg-bcg-green hover:text-white transition">ChatGPT</a>
                            <a href="https://gemini.google.com/" target="_blank" class="audio-target px-2 py-1 bg-gray-100 dark:bg-white/10 rounded text-[10px] hover:bg-bcg-green hover:text-white transition">Gemini</a>
                            <a href="https://aistudio.google.com/" target="_blank" class="audio-target px-2 py-1 bg-gray-100 dark:bg-white/10 rounded text-[10px] hover:bg-bcg-green hover:text-white transition">Google AI Studio</a>
                            <a href="https://notebooklm.google.com" target="_blank" class="audio-target px-2 py-1 bg-gray-100 dark:bg-white/10 rounded text-[10px] hover:bg-bcg-green hover:text-white transition">NotebookLM</a>
                            <a href="https://www.perplexity.ai" target="_blank" class="audio-target px-2 py-1 bg-gray-100 dark:bg-white/10 rounded text-[10px] hover:bg-bcg-green hover:text-white transition">Perplexity</a>
                            <a href="https://typeset.io" target="_blank" class="audio-target px-2 py-1 bg-gray-100 dark:bg-white/10 rounded text-[10px] hover:bg-bcg-green hover:text-white transition">SciSpace</a>
                            <a href="https://www.d-id.com" target="_blank" class="audio-target px-2 py-1 bg-gray-100 dark:bg-white/10 rounded text-[10px] hover:bg-bcg-green hover:text-white transition">D-ID</a>
                            <a href="https://elevenlabs.io" target="_blank" class="audio-target px-2 py-1 bg-gray-100 dark:bg-white/10 rounded text-[10px] hover:bg-bcg-green hover:text-white transition">ElevenLabs</a>
                            <a href="https://gamma.app" target="_blank" class="audio-target px-2 py-1 bg-gray-100 dark:bg-white/10 rounded text-[10px] hover:bg-bcg-green hover:text-white transition">Gamma</a>
                            <a href="https://www.mentimeter.com" target="_blank" class="audio-target px-2 py-1 bg-gray-100 dark:bg-white/10 rounded text-[10px] hover:bg-bcg-green hover:text-white transition">Mentimeter</a>
                        </div>
                    </div>
                    <div class="bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 p-6 rounded-lg">
                        <h4 class="font-bold mb-3 flex items-center text-bcg-green audio-target"><i class="fas fa-globe mr-2"></i> <span class="lang-en">Course Webpage</span><span class="lang-zh hidden">課程網頁</span></h4>
                        <div class="flex flex-col space-y-2">
                             <a href="https://lolopodcast.github.io/1142-ITBM-EMI/" target="_blank" class="audio-target flex items-center justify-between px-3 py-2 bg-bcg-green/10 border border-bcg-green/20 rounded text-xs font-bold text-bcg-green hover:bg-bcg-green hover:text-white transition group">
                                <span>1142 ITBM EMI</span>
                                <i class="fas fa-external-link-alt text-[10px]"></i>
                            </a>
                            <a href="https://lolopodcast.github.io/EMI-AI-Self-Introduction/" target="_blank" class="audio-target flex items-center justify-between px-3 py-2 bg-bcg-green/10 border border-bcg-green/20 rounded text-xs font-bold text-bcg-green hover:bg-bcg-green hover:text-white transition group">
                                <span>Self-Introduction Project: From Authentic to AI-Enhanced</span>
                                <i class="fas fa-external-link-alt text-[10px]"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 區塊：第一週 課程定位 -->
        <div id="section-w1-orientation" class="hidden animate-fade-in">
            <div class="mb-6 border-b border-gray-200 dark:border-gray-800 pb-4">
                <h2 class="text-2xl font-light text-bcg-green uppercase tracking-wider audio-target">
                    <span class="lang-en">W1 Orientation</span><span class="lang-zh hidden">第一週 課程定位</span>
                </h2>
            </div>
            <div id="content-pre-w1" class="space-y-6">
                <div class="bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-900/50 rounded-xl p-6 shadow-sm overflow-hidden relative audio-target">
                    <div class="absolute -top-4 -right-4 opacity-10 rotate-12"><i class="fas fa-shield-alt text-8xl text-red-600"></i></div>
                    <div class="relative z-10">
                        <div class="flex items-center mb-6">
                            <div class="w-10 h-10 rounded-full bg-red-600 flex items-center justify-center text-white mr-4 shadow-lg shadow-red-500/30"><i class="fas fa-exclamation-triangle"></i></div>
                            <div>
                                <h3 class="text-lg font-bold text-red-700 dark:text-red-400 uppercase tracking-tighter leading-none mb-1"><span class="lang-en">Critical Alerts & Expectations</span><span class="lang-zh hidden">重要警示與課堂期待</span></h3>
                                <p class="text-[10px] text-red-500 dark:text-red-500/70 font-mono uppercase tracking-widest"><span class="lang-en">Mandatory Requirements Phase</span><span class="lang-zh hidden">強制要求階段</span></p>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="p-4 bg-white/60 dark:bg-black/20 rounded-lg border border-red-100 dark:border-red-900/30">
                                <div class="flex items-center mb-2"><span class="w-5 h-5 rounded bg-red-600 text-white flex items-center justify-center text-[10px] font-bold mr-2">01</span><h4 class="text-xs font-bold text-gray-900 dark:text-white uppercase"><span class="lang-en">English Proficiency B1+ Required</span><span class="lang-zh hidden">英文能力 B1+ 要求</span></h4></div>
                                <p class="text-[11px] text-gray-600 dark:text-gray-400 leading-relaxed"><span class="lang-en">Weekly oral presentations in English are <strong>mandatory</strong>.</span><span class="lang-zh hidden">每週的英語口頭發表與小組討論為<strong>強制性</strong>要求，每位同學皆須發言。</span></p>
                            </div>
                            <div class="p-4 bg-white/60 dark:bg-black/20 rounded-lg border border-red-100 dark:border-red-900/30">
                                <div class="flex items-center mb-2"><span class="w-5 h-5 rounded bg-red-600 text-white flex items-center justify-center text-[10px] font-bold mr-2">02</span><h4 class="text-xs font-bold text-gray-900 dark:text-white uppercase"><span class="lang-en">Attendance</span><span class="lang-zh hidden">出席要求</span></h4></div>
                                <p class="text-[11px] text-gray-600 dark:text-gray-400 leading-relaxed"><span class="lang-en">Groups will be formed in Week 1.</span><span class="lang-zh hidden">第一週將進行分組。若您於 2/25 必須缺席，請務必事先於 Moodle 提交請假申請。</span></p>
                            </div>
                            <div class="p-4 bg-white/60 dark:bg-black/20 rounded-lg border border-red-100 dark:border-red-900/30">
                                <div class="flex items-center mb-2"><span class="w-5 h-5 rounded bg-red-600 text-white flex items-center justify-center text-[10px] font-bold mr-2">03</span><h4 class="text-xs font-bold text-gray-900 dark:text-white uppercase"><span class="lang-en">Bring Your Device</span><span class="lang-zh hidden">攜帶個人裝置</span></h4></div>
                                <p class="text-[11px] text-gray-600 dark:text-gray-400 leading-relaxed"><span class="lang-en">Please bring a <strong>laptop or tablet</strong> every week.</span><span class="lang-zh hidden">每週課程皆含生成式 AI 實作，請務必攜帶<strong>筆記型電腦或平板電腦</strong>上課。</span></p>
                            </div>
                            <div class="p-4 bg-white/60 dark:bg-black/20 rounded-lg border border-red-100 dark:border-red-900/30">
                                <div class="flex items-center mb-2"><span class="w-5 h-5 rounded bg-red-600 text-white flex items-center justify-center text-[10px] font-bold mr-2">04</span><h4 class="text-xs font-bold text-gray-900 dark:text-white uppercase"><span class="lang-en">Drop Policy</span><span class="lang-zh hidden">退選政策</span></h4></div>
                                <p class="text-[11px] text-gray-600 dark:text-gray-400 leading-relaxed"><span class="lang-en">If overwhelmed, drop early to allow waitlisted students to join.</span><span class="lang-zh hidden">若您感到壓力過大，請儘早退選課程，以便讓候補名單中的同學加入。</span></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-white dark:bg-white/5 border border-gray-200 dark:border-gray-800 rounded-xl p-6 shadow-xl backdrop-blur-md relative overflow-hidden audio-target">
                    <div class="absolute top-0 right-0 p-4 opacity-5 pointer-events-none"><i class="fas fa-microchip text-8xl"></i></div>
                    <div class="flex justify-between items-end mb-4">
                        <div class="flex flex-col"><h3 class="text-sm font-bold uppercase tracking-[0.2em] text-bcg-green"><span class="lang-en">Mission Status Checklist</span><span class="lang-zh hidden">任務達成狀態清單</span></h3></div>
                        <span id="progress-percent-w1" class="text-lg font-bold font-mono text-bcg-green">0%</span>
                    </div>
                    <div class="w-full h-1.5 bg-gray-200 dark:bg-white/10 rounded-full mb-8 overflow-hidden"><div class="mission-progress-bar h-full bg-bcg-green transition-all duration-700 ease-out shadow-[0_0_15px_rgba(23,122,70,0.6)]" style="width: 0%"></div></div>
                    <div class="space-y-4">
                        <label class="relative block cursor-pointer group"><input type="checkbox" class="tech-check hidden peer"><div class="flex items-center p-4 bg-gray-50 dark:bg-white/5 border border-gray-200 dark:border-gray-800 rounded-lg group-hover:border-bcg-green/40 transition-all duration-300"><div class="w-8 h-8 rounded-md bg-white dark:bg-white/10 flex items-center justify-center text-gray-400 group-hover:text-bcg-green transition peer-checked:bg-bcg-green peer-checked:text-white shrink-0"><i class="fas fa-check text-xs"></i></div><div class="ml-4 flex-1"><div class="flex justify-between items-start"><p class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-bcg-green transition task-title"><span class="lang-en">1. Fulfill personal form</span><span class="lang-zh hidden">1. 填寫個人資料表單</span></p><span class="text-[9px] px-1.5 py-0.5 rounded bg-bcg-green/10 text-bcg-green font-bold uppercase tracking-tighter border border-bcg-green/20"><span class="lang-en">Required</span><span class="lang-zh hidden">必填項目</span></span></div><div class="mt-2 flex flex-col space-y-1.5"><div><a href="https://forms.gle/SL5KpnzwuyvW9bp69" target="_blank" class="inline-flex items-center px-3 py-1 bg-bcg-green text-white text-[10px] font-bold rounded hover:bg-green-700 transition-all shadow-lg shadow-bcg-green/20"><i class="fas fa-link mr-1.5"></i> <span class="lang-en">Open Form Link</span><span class="lang-zh hidden">點擊開啟表單</span></a></div><p class="text-[11px] font-bold text-red-600 dark:text-red-400 italic"><span class="lang-en">Must be completed by 2/24 23:59</span><span class="lang-zh hidden">須於 2/24 23:59 前完成</span></p></div></div></div></label>
                        <label class="relative block cursor-pointer group"><input type="checkbox" class="tech-check hidden peer"><div class="flex items-center p-4 bg-gray-50 dark:bg-white/5 border border-gray-200 dark:border-gray-800 rounded-lg group-hover:border-bcg-green/40 transition-all duration-300"><div class="w-8 h-8 rounded-md bg-white dark:bg-white/10 flex items-center justify-center text-gray-400 group-hover:text-bcg-green transition peer-checked:bg-bcg-green peer-checked:text-white shrink-0"><i class="fas fa-check text-xs"></i></div><div class="ml-4 flex-1"><div class="flex justify-between items-start"><div class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-bcg-green transition task-title"><span class="lang-en">2. Read Prof. Lo's Bio</span><span class="lang-zh hidden">2. 閱讀駱教授簡歷</span></div><span class="text-[9px] px-1.5 py-0.5 rounded bg-blue-500/10 text-blue-500 font-bold uppercase tracking-tighter border border-blue-500/20"><span class="lang-en">Review</span><span class="lang-zh hidden">詳閱項目</span></span></div><div class="mt-2"><a href="https://drive.google.com/file/d/1H0UeqOG2sax8frL12roHHTeDqqh2a6x1/view" target="_blank" class="inline-flex items-center px-3 py-1 bg-blue-500/10 text-blue-600 dark:text-blue-400 text-[10px] font-bold rounded hover:bg-blue-600 hover:text-white transition-all border border-blue-500/20"><i class="fas fa-file-pdf mr-1.5"></i> <span class="lang-en">Open Biography Link</span><span class="lang-zh hidden">點擊開啟簡歷連結</span></a></div></div></div></label>
                    </div>
                </div>
            </div>
        </div>

        <!-- 區塊：第二週 課程啟航 -->
        <div id="section-w2-onboarding" class="hidden animate-fade-in">
            <div class="mb-6 border-b border-gray-200 dark:border-gray-800 pb-4">
                <h2 class="text-2xl font-light text-bcg-green uppercase tracking-wider audio-target">
                    <span class="lang-en">W2 Onboarding</span><span class="lang-zh hidden">第二週 課程啟航</span>
                </h2>
            </div>

            <!-- 提醒模組 -->
            <div class="bg-blue-50 dark:bg-blue-900/10 border border-blue-200 dark:border-blue-900/50 rounded-xl p-6 shadow-sm mb-8 relative audio-target">
                <div class="absolute -top-4 -right-4 opacity-10 rotate-12 text-blue-600">
                    <i class="fas fa-bell text-8xl"></i>
                </div>
                <div class="relative z-10">
                    <h3 class="text-lg font-bold text-blue-700 dark:text-blue-400 uppercase tracking-tighter mb-4 flex items-center">
                        <i class="fas fa-bullhorn mr-2"></i>
                        <span class="lang-en">Weekly Important Reminders</span>
                        <span class="lang-zh hidden">本週重要提醒事項</span>
                    </h3>
                    <ul class="space-y-3 text-xs sm:text-sm text-gray-700 dark:text-gray-300">
                        <li class="flex items-start">
                            <span class="w-5 h-5 rounded bg-blue-600 text-white flex items-center justify-center text-[10px] font-bold mr-3 shrink-0 mt-0.5">01</span>
                            <p>
                                <span class="lang-en">Please bring your <strong>laptop or tablet</strong> to class for practical GenAI operation.</span>
                                <span class="lang-zh hidden">請務必<strong>攜帶筆電或平板</strong>至課堂進行生成式 AI 實際操作。</span>
                            </p>
                        </li>
                        <li class="flex items-start">
                            <span class="w-5 h-5 rounded bg-blue-600 text-white flex items-center justify-center text-[10px] font-bold mr-3 shrink-0 mt-0.5">02</span>
                            <p>
                                <span class="lang-en"><strong>Group Leaders Only:</strong> Please ensure you have joined the Moodle W1 LINE group. Group leaders are responsible for relaying group messages to all members.</span>
                                <span class="lang-zh hidden"><strong>只限小組組長：</strong>請務必加入 Moodle W1 賴群。組長需負責將賴群中的重要訊息轉達到小組內。</span>
                            </p>
                        </li>
                        <li class="flex items-start">
                            <span class="w-5 h-5 rounded bg-blue-600 text-white flex items-center justify-center text-[10px] font-bold mr-3 shrink-0 mt-0.5">03</span>
                            <p>
                                <span class="lang-en">Visit Moodle at least <strong>once a week</strong>. Continuous Moodle engagement is a key metric for learning performance and counts toward your final grade.</span>
                                <span class="lang-zh hidden">每週請<strong>瀏覽 Moodle 至少一次</strong>。定期登入紀錄將作為學習表現考核的一部分，並計入學期總成績。</span>
                            </p>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- 第二週 任務清單 -->
            <div class="bg-white dark:bg-white/5 border border-gray-200 dark:border-gray-800 rounded-xl p-6 shadow-xl backdrop-blur-md relative overflow-hidden audio-target">
                <div class="absolute top-0 right-0 p-4 opacity-5 pointer-events-none"><i class="fas fa-rocket text-8xl"></i></div>
                <div class="flex justify-between items-end mb-4">
                    <div class="flex flex-col"><h3 class="text-sm font-bold uppercase tracking-[0.2em] text-bcg-green"><span class="lang-en">W2 Mission Checklist</span><span class="lang-zh hidden">第二週 任務達成狀態清單</span></h3></div>
                    <span id="progress-percent-w2" class="text-lg font-bold font-mono text-bcg-green">0%</span>
                </div>
                <div class="w-full h-1.5 bg-gray-200 dark:bg-white/10 rounded-full mb-8 overflow-hidden"><div class="mission-progress-bar h-full bg-bcg-green transition-all duration-700 ease-out shadow-[0_0_15px_rgba(23,122,70,0.6)]" style="width: 0%"></div></div>

                <div class="space-y-4" id="checklist-w2">
                    <!-- 任務 1 -->
                    <label class="relative block cursor-pointer group">
                        <input type="checkbox" class="tech-check hidden peer">
                        <div class="flex items-center p-4 bg-gray-50 dark:bg-white/5 border border-gray-200 dark:border-gray-800 rounded-lg group-hover:border-bcg-green/40 transition-all duration-300">
                            <div class="w-8 h-8 rounded-md bg-white dark:bg-white/10 flex items-center justify-center text-gray-400 group-hover:text-bcg-green transition peer-checked:bg-bcg-green peer-checked:text-white shrink-0"><i class="fas fa-check text-xs"></i></div>
                            <div class="ml-4 flex-1">
                                <div class="flex justify-between items-start">
                                    <p class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-bcg-green transition task-title">
                                        <span class="lang-en">1. Print & Bring Name Card</span><span class="lang-zh hidden">1. 列印並攜帶個人名卡</span>
                                    </p>
                                    <span class="text-[9px] px-1.5 py-0.5 rounded bg-bcg-green/10 text-bcg-green font-bold uppercase tracking-tighter border border-bcg-green/20">Class prep</span>
                                </div>
                                <div class="mt-2 text-[11px] text-gray-500">
                                    <p class="text-red-600 dark:text-red-400 font-bold italic underline">
                                        <span class="lang-en">Note: Sample template available on Moodle W2.</span>
                                        <span class="lang-zh hidden">注意：Moodle W2 有範例檔案可直接下載編輯。</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </label>

                    <!-- 任務 2 -->
                    <label class="relative block cursor-pointer group">
                        <input type="checkbox" class="tech-check hidden peer">
                        <div class="flex items-center p-4 bg-gray-50 dark:bg-white/5 border border-gray-200 dark:border-gray-800 rounded-lg group-hover:border-bcg-green/40 transition-all duration-300">
                            <div class="w-8 h-8 rounded-md bg-white dark:bg-white/10 flex items-center justify-center text-gray-400 group-hover:text-bcg-green transition peer-checked:bg-bcg-green peer-checked:text-white shrink-0"><i class="fas fa-check text-xs"></i></div>
                            <div class="ml-4 flex-1">
                                <div class="flex justify-between items-start">
                                    <p class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-bcg-green transition task-title">
                                        <span class="lang-en">2. 1-Minute YT Self-Introduction Video</span><span class="lang-zh hidden">2. 1 分鐘 YT 自我介紹影片</span>
                                    </p>
                                    <span class="text-[9px] px-1.5 py-0.5 rounded bg-red-500/10 text-red-500 font-bold uppercase tracking-tighter border border-red-500/20">Required</span>
                                </div>
                                <div class="mt-2 text-[11px] text-gray-500 space-y-1.5">
                                    <p><span class="lang-en">Upload to YT and share link on Moodle W2.</span><span class="lang-zh hidden">上傳至 YT 並分享連結至 Moodle W2。</span></p>
                                    <p class="text-red-600 dark:text-red-400 font-bold italic underline">
                                        <span class="lang-en">Avoid 'Made for Kids' and YouTube Shorts.</span>
                                        <span class="lang-zh hidden">注意：影片不要設為兒童模式或上傳為 YouTube 短影音 (Shorts)。</span>
                                    </p>
                                    <p class="font-bold text-red-700 dark:text-red-500 uppercase tracking-wide">
                                        <span class="lang-en">Deadline: 2/28 23:59</span>
                                        <span class="lang-zh hidden">截止日期：2/28 23:59</span>
                                    </p>
                                    <p class="text-gray-400 italic">
                                        <span class="lang-en">Please visit Moodle for more specific details.</span>
                                        <span class="lang-zh hidden">請至 Moodle 查看更詳細的內容。</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </label>

                    <!-- 任務 3 -->
                    <label class="relative block cursor-pointer group">
                        <input type="checkbox" class="tech-check hidden peer">
                        <div class="flex items-center p-4 bg-gray-50 dark:bg-white/5 border border-gray-200 dark:border-gray-800 rounded-lg group-hover:border-bcg-green/40 transition-all duration-300">
                            <div class="w-8 h-8 rounded-md bg-white dark:bg-white/10 flex items-center justify-center text-gray-400 group-hover:text-bcg-green transition peer-checked:bg-bcg-green peer-checked:text-white shrink-0"><i class="fas fa-check text-xs"></i></div>
                            <div class="ml-4 flex-1">
                                <div class="flex justify-between items-start">
                                    <p class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-bcg-green transition task-title">
                                        <span class="lang-en">3. Group Desert Survival Coggle</span><span class="lang-zh hidden">3. 團體沙漠求生 Coggle 檔案</span>
                                    </p>
                                    <span class="text-[9px] px-1.5 py-0.5 rounded bg-blue-500/10 text-blue-500 font-bold uppercase tracking-tighter border border-blue-500/20">Group task</span>
                                </div>
                                <div class="mt-2 text-[11px] text-gray-500 space-y-1.5">
                                    <p><span class="lang-en">Upload PDF to Moodle W2.</span><span class="lang-zh hidden">上傳 PDF 檔至 Moodle W2。</span></p>
                                    <p class="font-bold text-red-700 dark:text-red-500 uppercase tracking-wide">
                                        <span class="lang-en">Deadline: 3/3 23:59</span>
                                        <span class="lang-zh hidden">截止日期：3/3 23:59</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </label>

                    <!-- 任務 4 -->
                    <label class="relative block cursor-pointer group">
                        <input type="checkbox" class="tech-check hidden peer">
                        <div class="flex items-center p-4 bg-gray-50 dark:bg-white/5 border border-gray-200 dark:border-gray-800 rounded-lg group-hover:border-bcg-green/40 transition-all duration-300">
                            <div class="w-8 h-8 rounded-md bg-white dark:bg-white/10 flex items-center justify-center text-gray-400 group-hover:text-bcg-green transition peer-checked:bg-bcg-green peer-checked:text-white shrink-0"><i class="fas fa-check text-xs"></i></div>
                            <div class="ml-4 flex-1">
                                <div class="flex justify-between items-start">
                                    <p class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-bcg-green transition task-title">
                                        <span class="lang-en">4. Survival Website Result-Team PDF (Group Leader upload Only)</span><span class="lang-zh hidden">4. 團體沙漠求生網站 PDF (僅限組長上傳)</span>
                                    </p>
                                    <span class="text-[9px] px-1.5 py-0.5 rounded bg-blue-500/10 text-blue-500 font-bold uppercase tracking-tighter border border-blue-500/20">Leader only</span>
                                </div>
                                <div class="mt-2 text-[11px] text-gray-500 space-y-1.5">
                                    <p><span class="lang-en">Generate and upload PDF to Moodle W2.</span><span class="lang-zh hidden">由網站生成並轉檔後，上傳 PDF 至 Moodle W2。</span></p>
                                    <p class="font-bold text-red-700 dark:text-red-500 uppercase tracking-wide">
                                        <span class="lang-en">Deadline: 3/3 23:59</span>
                                        <span class="lang-zh hidden">截止日期：3/3 23:59</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </label>

                    <!-- 任務 5 -->
                    <label class="relative block cursor-pointer group">
                        <input type="checkbox" class="tech-check hidden peer">
                        <div class="flex items-center p-4 bg-gray-50 dark:bg-white/5 border border-gray-200 dark:border-gray-800 rounded-lg group-hover:border-bcg-green/40 transition-all duration-300">
                            <div class="w-8 h-8 rounded-md bg-white dark:bg-white/10 flex items-center justify-center text-gray-400 group-hover:text-bcg-green transition peer-checked:bg-bcg-green peer-checked:text-white shrink-0"><i class="fas fa-check text-xs"></i></div>
                            <div class="ml-4 flex-1">
                                <div class="flex justify-between items-start">
                                    <p class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-bcg-green transition task-title">
                                        <span class="lang-en">5. Presentation Preparation</span><span class="lang-zh hidden">5. 報告準備</span>
                                    </p>
                                    <span class="text-[9px] px-1.5 py-0.5 rounded bg-purple-500/10 text-purple-500 font-bold uppercase tracking-tighter border border-purple-500/20">Class 3/5</span>
                                </div>
                                <div class="mt-2 text-[11px] text-gray-500 space-y-1.5">
                                    <p><span class="lang-en">Topic: Group Desert Survival Coggle. Duration: ~15 mins.</span><span class="lang-zh hidden">主題：團體沙漠求生 Coggle。時間：約15分鐘。</span></p>
                                    <p class="text-red-600 dark:text-red-400 font-bold italic underline">
                                        <span class="lang-en">Note: Every team member must present.</span>
                                        <span class="lang-zh hidden">注意：每位團員都必須參與報告。</span>
                                    </p>
                                    <p class="font-bold text-red-700 dark:text-red-500 uppercase tracking-wide">
                                        <span class="lang-en">Deadline: 3/4 23:59</span>
                                        <span class="lang-zh hidden">截止日期：3/4 23:59</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </label>
                </div>

                <div class="mt-6 flex items-center text-[10px] text-gray-500 font-mono uppercase tracking-widest">
                    <i class="fas fa-info-circle mr-2 text-bcg-green animate-pulse"></i>
                    <span class="lang-en">All members are expected to contribute to team tasks.</span>
                    <span class="lang-zh hidden">所有團員均應對團隊任務做出貢獻。</span>
                </div>
            </div>
        </div>

    </main>

    <!-- 頁尾 -->
    <footer class="fixed bottom-0 w-full min-h-[3.5rem] h-auto bg-white dark:bg-black/95 border-t border-gray-200 dark:border-gray-800 flex items-center justify-between px-3 md:px-6 z-50 text-xs py-2">
        <div class="flex flex-col">
            <a href="https://www.ibs.ncnu.edu.tw/" target="_blank" class="hover:text-bcg-green transition-colors">
                <span class="text-[9px] text-gray-500 font-mono leading-tight">1142 ITBM-EMI Hub &copy; NCNU IBS</span>
            </a>
            <span class="text-gray-800 dark:text-gray-300 font-medium tracking-tighter leading-tight mt-0.5">
                <a href="https://mail.google.com/mail/?view=cm&fs=1&to=shihmin@ncnu.edu.tw" target="_blank" class="hover:text-bcg-green transition-colors">
                    <span class="lang-en">Prof. Shihmin Lo</span><span class="lang-zh hidden">駱世民教授</span>
                </a>
            </span>
        </div>
        <div class="flex flex-col items-end text-[10px] text-bcg-green font-bold">
            <span class="uppercase tracking-widest"><span class="lang-en">Digital Learning</span><span class="lang-zh hidden">數位學習中心</span></span>
            <div class="text-gray-400 font-normal flex flex-col items-end leading-none mt-1 space-y-1">
                <span class="text-[8px] opacity-70">TAs:</span>
                <div class="text-right">
                    <span class="lang-en text-[7px] md:text-[8px]">Tina:</span><span class="lang-zh hidden text-[7px] md:text-[8px]">林庭伃:</span> 
                    <a href="https://mail.google.com/mail/?view=cm&fs=1&to=s113212016@mail1.ncnu.edu.tw" target="_blank" class="hover:underline text-bcg-green font-mono text-[7px] md:text-[8px] break-all">s113212016@mail1.ncnu.edu.tw</a>
                </div>
                <div class="text-right">
                    <span class="lang-en text-[7px] md:text-[8px]">Zoe:</span><span class="lang-zh hidden text-[7px] md:text-[8px]">莊詠捷:</span> 
                    <a href="https://mail.google.com/mail/?view=cm&fs=1&to=s113251013@mail1.ncnu.edu.tw" target="_blank" class="hover:underline text-bcg-green font-mono text-[7px] md:text-[8px] break-all">s113251013@mail1.ncnu.edu.tw</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        let currentLang = 'en';
        let isDarkMode = true;
        let isAudioPlaying = false;
        let missionCompleteModalShown = false;
        let currentUtterance = null;
        
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        const audioBtn = document.getElementById('audio-btn');
        const langToggle = document.getElementById('lang-toggle');

        if (localStorage.theme === 'light') {
            isDarkMode = false;
            document.documentElement.classList.remove('dark');
        }

        document.getElementById('theme-toggle').addEventListener('click', () => {
            isDarkMode = !isDarkMode;
            document.documentElement.classList.toggle('dark', isDarkMode);
            localStorage.theme = isDarkMode ? 'dark' : 'light';
        });

        langToggle.addEventListener('click', () => {
            currentLang = currentLang === 'en' ? 'zh' : 'en';
            document.querySelectorAll('.lang-en').forEach(el => {
                if(currentLang === 'en') el.classList.remove('hidden');
                else el.classList.add('hidden');
            });
            document.querySelectorAll('.lang-zh').forEach(el => {
                if(currentLang === 'zh') el.classList.remove('hidden');
                else el.classList.add('hidden');
            });
            if(isAudioPlaying) stopAudio();
        });

        window.switchSection = function(e, sectionId) {
            if (e) e.preventDefault();
            
            const sections = ['overview', 'w1-orientation', 'w2-onboarding'];
            sections.forEach(id => {
                const el = document.getElementById('section-' + id);
                if(el) el.classList.add('hidden');
            });
            
            const target = document.getElementById('section-' + sectionId);
            if(target) {
                target.classList.remove('hidden');
            }
            
            document.querySelectorAll('#sidebar a').forEach(el => {
                el.classList.remove('border-bcg-green', 'bg-gray-100', 'dark:bg-white/5', 'text-bcg-green', 'dark:text-white');
                el.classList.add('border-transparent', 'text-gray-700', 'dark:text-gray-400');
            });
            
            const activeNav = document.getElementById('nav-' + sectionId);
            if(activeNav) {
                activeNav.classList.remove('border-transparent', 'text-gray-700', 'dark:text-gray-400');
                activeNav.classList.add('border-bcg-green', 'bg-gray-100', 'dark:bg-white/5', 'text-bcg-green', 'dark:text-white');
            }

            if(isAudioPlaying) stopAudio();
            if (!sidebar.classList.contains('-translate-x-full')) toggleSidebar();
            window.scrollTo(0,0);
            updateProgress(); // 切換時同步更新進度條
        }

        function toggleSidebar() {
            const isClosed = sidebar.classList.contains('-translate-x-full');
            sidebar.classList.toggle('-translate-x-full', !isClosed);
            overlay.classList.toggle('hidden', !isClosed);
        }

        function updateProgress() {
            const activeSection = Array.from(document.querySelectorAll('main > div')).find(d => !d.classList.contains('hidden'));
            if (!activeSection) return;

            const techChecks = activeSection.querySelectorAll('.tech-check');
            if (techChecks.length === 0) return;

            const total = techChecks.length;
            const checked = Array.from(techChecks).filter(c => c.checked).length;
            const percentage = Math.round((checked / total) * 100);
            
            const progressPercent = activeSection.querySelector('[id^="progress-percent-"]');
            const progressBar = activeSection.querySelector('.mission-progress-bar');
            
            if (progressPercent) progressPercent.textContent = percentage + '%';
            if (progressBar) progressBar.style.width = percentage + '%';

            if (percentage === 100) {
                setTimeout(showMissionComplete, 800);
            }
        }

        function showMissionComplete() {
            const modal = document.getElementById('complete-modal');
            modal.classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('complete-modal').classList.add('hidden');
        }

        document.addEventListener('change', (e) => {
            if (e.target.classList.contains('tech-check')) {
                updateProgress();
            }
        });

        document.getElementById('menu-btn').addEventListener('click', toggleSidebar);
        overlay.addEventListener('click', toggleSidebar);

        audioBtn.addEventListener('click', () => {
            if(isAudioPlaying) stopAudio();
            else playAudio();
        });

        function playAudio() {
            if (!('speechSynthesis' in window)) return;
            window.speechSynthesis.cancel();
            
            setTimeout(() => {
                const activeSection = Array.from(document.querySelectorAll('main > div')).find(d => !d.classList.contains('hidden'));
                if (!activeSection) return;

                let textParts = [];
                const targets = Array.from(activeSection.querySelectorAll('.audio-target'));
                
                targets.forEach(el => {
                    const style = window.getComputedStyle(el);
                    if (style.display === 'none' || style.visibility === 'hidden') return;
                    const clone = el.cloneNode(true);
                    clone.querySelectorAll('.hidden').forEach(h => h.remove());
                    clone.querySelectorAll('.keyword').forEach(k => k.removeAttribute('data-tip'));
                    const text = clone.innerText.trim();
                    if (text && !textParts.includes(text)) textParts.push(text);
                });

                if (textParts.length === 0) {
                    const headers = activeSection.querySelectorAll('h2, h3, h4');
                    headers.forEach(h => {
                        const clone = h.cloneNode(true);
                        clone.querySelectorAll('.hidden').forEach(lang => lang.remove());
                        const text = clone.innerText.trim();
                        if (text) textParts.push(text);
                    });
                }

                const finalMessage = textParts.join('. ').replace(/\s+/g, ' ');
                if (!finalMessage) return;

                const utterance = new SpeechSynthesisUtterance(finalMessage);
                currentUtterance = utterance; 
                utterance.lang = currentLang === 'en' ? 'en-US' : 'zh-TW';
                utterance.rate = 1.0;
                utterance.pitch = 1.0;
                utterance.volume = 1.0;

                utterance.onstart = () => {
                    isAudioPlaying = true;
                    audioBtn.classList.add('text-bcg-green', 'animate-pulse');
                };
                utterance.onend = () => {
                    isAudioPlaying = false;
                    audioBtn.classList.remove('text-bcg-green', 'animate-pulse');
                    currentUtterance = null;
                };
                utterance.onerror = (event) => {
                    if (event.error !== 'interrupted') {
                        console.error('SpeechSynthesisError:', event.error);
                    }
                    stopAudio();
                };
                window.speechSynthesis.speak(utterance);
            }, 150);
        }

        function stopAudio() {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
            }
            isAudioPlaying = false;
            audioBtn.classList.remove('text-bcg-green', 'animate-pulse');
            currentUtterance = null;
        }

        // --- 處理手機版 Tooltip 溢出與置中邏輯 ---
        document.addEventListener('DOMContentLoaded', () => {
            document.addEventListener('click', (e) => {
                const keywordEl = e.target.closest('.keyword');
                
                if (keywordEl) {
                    e.stopPropagation();
                    const wasActive = keywordEl.classList.contains('show-tip');
                    
                    document.querySelectorAll('.keyword').forEach(el => el.classList.remove('show-tip'));
                    
                    if (!wasActive) {
                        const rect = keywordEl.getBoundingClientRect();
                        const screenWidth = window.innerWidth;
                        const wordCenter = rect.left + rect.width / 2;
                        
                        let transformX = "-50%";
                        if (screenWidth <= 640) {
                            const offset = (screenWidth / 2) - wordCenter;
                            transformX = `translateX(calc(-50% + ${offset}px))`;
                        }
                        
                        keywordEl.style.setProperty('--tip-left', '50%');
                        keywordEl.style.setProperty('--tip-transform', transformX);
                        keywordEl.classList.add('show-tip');
                    }
                } else {
                    document.querySelectorAll('.keyword').forEach(el => el.classList.remove('show-tip'));
                }
            });

            document.querySelectorAll('.keyword').forEach(k => {
                k.addEventListener('contextmenu', (e) => {
                    if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
                        e.preventDefault();
                    }
                });
            });
        });
    </script>
</body>
</html>